const t=Object.freeze({required:t=>`${t} is required`,maxlength:t=>`${t} is too long`,max:(t,e)=>`${t} must be less than or equal to ${e}`,minlength:t=>`${t} is too short`,min:(t,e)=>`${t} must be greater than or equal to ${e}`,pattern:t=>`${t} has a pattern mismatch`,badInput:t=>`${t} has bad input`,stepMismatch:t=>`${t} has a step mismatch`,typeMismatch:t=>`${t} is not in the correct syntax`,unknown:t=>`${t} has an unknown error`});function getFormComponent(t){switch(t.tagName.toLowerCase()){case"input":return t.closest("form-input");case"select":return t.closest("form-select");case"textarea":return t.closest("form-textarea")}}const e={autocomplete:{type:String},autofocus:{type:Boolean},disabled:{type:Boolean},helpText:{type:String},id:{type:String},label:{type:String},name:{type:String,required:!0},readonly:{type:Boolean},required:{type:Boolean},size:{type:Number,default:20},tabindex:{type:Number},title:{type:String}},s={...e,accept:{type:String},capture:{type:String},checked:{type:Boolean,default:!1},dirname:{type:String},inline:{type:Boolean},inputmode:{type:String},list:{type:String},max:{type:Number,default:Number.MAX_VALUE},maxlength:{type:Number,default:0},min:{type:Number,default:Number.MIN_VALUE},minlength:{type:Number,default:0},multiple:{type:Boolean,default:!1},pattern:{type:String},placeholder:{type:String},step:{type:Number,default:1},switch:{type:Boolean},type:{type:String,default:"text"},value:{type:String}};function generateId(t){return`${t?t+"-":""}${Date.now().toString(36)+Math.random().toString(36).substr(2)}`}const r=Object.freeze({CHECKBOX:"checkbox",COLOR:"color",DATE:"date",DATE_TIME:"datetime-local",EMAIL:"email",FILE:"file",HIDDEN:"hidden",MONTH:"month",NUMBER:"number",PASSWORD:"password",RADIO:"radio",RANGE:"range",SEARCH:"search",SUBMIT:"submit",TEL:"tel",TEXT:"text",TIME:"time",URL:"url",WEEK:"week"}),i=[r.DATE,r.MONTH,r.WEEK,r.TIME,r.DATE_TIME,r.NUMBER,r.RANGE],o=[r.PASSWORD,r.SEARCH,r.TEL,r.TEXT,r.URL],n=[r.HIDDEN,r.SUBMIT],a={accept:[r.FILE],capture:[r.FILE],dirname:[r.SEARCH,r.TEXT],max:i,maxlength:o,min:i,minlength:o,multiple:[r.EMAIL,r.FILE],pattern:[r.PASSWORD,r.TEL,r.TEXT],placeholder:o,size:[r.EMAIL,r.PASSWORD,r.TEL,r.TEXT],step:i,tabindex:Object.values(r)},l={max:Number.MAX_VALUE,maxlength:s.maxlength.default,min:Number.MIN_VALUE,minlength:s.minlength.default,multiple:s.multiple.default,size:s.size.default,step:1,tabindex:0},p=["id","label","helpText"];function toKebabCase(t){return t.replace(/([A-Z])/g,"-$1").toLowerCase()}function setBooleanAttribute(t,e,s,r){const i=function(t){return t||void 0}(r),o=toKebabCase(e);t.hasAttribute(o)&&!i?t.removeAttribute(o):i&&t.setAttribute(o,"")}function setNumericAttribute(t,e,s,r,i){let o=r;a[e]&&(o=function(t,e,s,r){return-1!==e.indexOf(t.type)&&0!==s&&s!==r?s:void 0}(i,a[e],r,l[e]));const n=toKebabCase(e);t.hasAttribute(n)&&null==o?t.removeAttribute(n):null!=o&&t.setAttribute(n,o)}function setAttribute(t,e,s,r,i){if(function(t){return-1!==p.indexOf(t)}(e))return;let o=s;a[e]&&(o=function(t,e,s,r){return-1!==e.indexOf(t.type)&&s!==r?s:void 0}(r,a[e],s));const n=toKebabCase(e);t.hasAttribute(n)&&null==o?t.removeAttribute(n):null!=o&&t.setAttribute(n,o)}function setAttributes(t,e,s){for(const r in s)switch(e[r].type){case Boolean:setBooleanAttribute(t,r,e[r],s[r]);break;case Number:setNumericAttribute(t,r,e[r],s[r],s);break;default:setAttribute(t,r,s[r],s)}}const u={...e,inline:{type:Boolean},multiple:{type:Boolean,default:!1},options:{type:Array}};class c{constructor(t,e,s=!1){this.label=t,this.options=e,this.disabled=s}}class d{constructor(t,e,s=!1,r=!1){this.label=t,this.value=e,this.selected=s,this.disabled=r}}const m={...e,cols:{type:Number,default:20},maxlength:{type:Number,default:0},minlength:{type:Number,default:0},placeholder:{type:String},rows:{type:Number,default:3},spellcheck:{type:Boolean},wrap:{type:String}};const h={create(e){!function({createComponent:e,renderer:s,html:r}){e("fc-form",{renderer:s,props:{options:{type:Object}},created(){this._touchedElements={},this._customValidators={},this._messages={...t},this.props.options&&this.props.options.messages&&(this._messages={...this._messages,...this.props.options.messages}),this.props.options&&this.props.options.customValidators&&(this._customValidators={...this.props.options.customValidators})},onSubmit(t){t.preventDefault(),t.stopPropagation(),t.target.checkValidity()?this.emitFormEvent(t):this.showErrors(t.target)},showErrors(t){Array.from(t.elements).filter((t=>/input|select|textarea/.test(t.tagName.toLowerCase()))).forEach((t=>{this.setTouched(t),this.showError(t)}))},getFormData(){const t=this.querySelector("form"),e=new FormData(t),s={};for(const t of e.entries())s[t[0]]=t[1];return{formData:e,data:s}},getFormComponents(){const t=this.querySelector("form");return Array.from(t.elements).map((t=>getFormComponent(t)))},getNativeFormElements(){return this.querySelector("form").elements},addCustomValidator(t,e){this._customValidators[t]=e},onReset(t){t.preventDefault(),t.stopPropagation(),this.emitFormEvent(t)},onInput(t){this.handleInputOrChange(t)},onChange(t){this.handleInputOrChange(t)},emitFormEvent(t){const{formData:e,data:s}=this.getFormData(t.target);this.emit(t.type,{form:this,nativeFormElement:t.target,formData:e,data:s,originalEvent:t})},handleInputOrChange(t){t.preventDefault(),t.stopPropagation();const e=t.target;this.setTouched(e),this.showError(e);const s=getFormComponent(e);this.emit(t.type,{component:s,nativeFormElement:e,name:e.getAttribute("name"),value:t.target.value,originalEvent:t})},setTouched(t){const e=t.getAttribute("name");e&&!this._touchedElements[e]&&(this._touchedElements[e]={formInput:t,touched:!0},t.classList.add("ms-is-touched"))},showError(t){const e=getFormComponent(t),s=t.closest(".fc-form__group"),r=s.querySelector(".fc-form__invalid-feedback"),i=s.querySelector("form-help-text"),clearInputValidation=()=>{t.setCustomValidity(""),r.textContent="",r.classList.remove("fc-form__invalid-feedback--show"),i.style.display="block"},o=e?e.getAttribute("label"):"Input",n=t.getAttribute("name");if(n&&this._customValidators[n]){const e=this._customValidators[n](o,t.value,t);e?(t.setCustomValidity(e),r.textContent=e,r.classList.add("fc-form__invalid-feedback--show"),i.style.display="none"):clearInputValidation()}else t.validity.valid?clearInputValidation():(r.textContent=this.getMessage(t,o),r.classList.add("fc-form__invalid-feedback--show"),i.style.display="none")},getMessage(t,e){return t.validity.valueMissing?this._messages.required(e):t.validity.badInput?this._messages.badInput(e):t.validity.patternMismatch?this._messages.pattern(e):t.validity.rangeOverflow?this._messages.max(e,t.max):t.validity.rangeUnderflow?this._messages.min(e,t.min):t.validity.stepMismatch?this._messages.stepMismatch(e):t.validity.tooLong?this._messages.maxlength(e):t.validity.tooShort?this._messages.minlength(e):t.validity.typeMismatch?this._messages.typeMismatch(e):this._messages.unknown(e)},mounted(){const t=this.querySelector("form");t.addEventListener("submit",this.onSubmit),t.addEventListener("reset",this.onReset),t.addEventListener("input",this.onInput),t.addEventListener("change",this.onChange)},render(){return r`<form novalidate>${this.slots.default}</form>`}})}(e),function({createComponent:t,renderer:e,html:s}){t("fc-help-text",{renderer:e,render(){return s`<div class="fc-form__help-text">${this.slots.default}</div>`}})}(e),function({createComponent:t,renderer:e,html:s}){t("fc-label",{renderer:e,props:{for:{type:String},block:{type:Boolean},required:{type:Boolean}},computed:{labelClassName(){return this.slots.default||this.props.for?"fc-form__label"+(this.props.block?" fc-form__label--block":""):"fc-form__label--hidden"}},setAttributes(){const t=this.querySelector("label");!this.props.for||t.hasAttribute("for")&&t.getAttribute("for")===this.props.for||t.setAttribute("for",this.props.for),this.props.required&&!t.hasAttribute("required")&&t.setAttribute("required","")},mounted(){this.setAttributes()},updated(){this.setAttributes()},render(){return s`<label class="${this.labelClassName}">${this.slots.default}</label>`}})}(e),function({createComponent:t,renderer:e,html:i,nothing:o}){t("fc-input",{renderer:e,props:s,computed:{internalId(){return this.props.id?this.props.id:generateId("input")},className(){return this.props.type===r.RADIO||this.props.type===r.CHECKBOX?"fc-form__check"+(this.props.switch?" fc-form__switch":""):this.props.type===r.RANGE?"fc-form__range":this.props.type===r.SUBMIT?"fc-form__submit":"fc-form__control"},containerClassName(){return this.props.inline||this.props.type===r.SUBMIT?"fc-form__group fc-form__group--inline":this.props.type===r.RADIO||this.props.type===r.CHECKBOX?"fc-form__group fc-form__group--rc":"fc-form__group"},inputClassName(){return this.props.type===r.RADIO||this.props.type===r.CHECKBOX?"fc-form__input fc-form__input--reverse":"fc-form__input"},isValidType(){return-1!==Object.values(r).indexOf(this.props.type)},for(){return n.indexOf(this.props.type)>-1||!this.props.label?"":this.internalId}},created(){if(!this.isValidType)throw new Error(`${this.props.type} is not a valid input type`)},mounted(){setAttributes(this.querySelector("input"),s,this.props)},updated(){setAttributes(this.querySelector("input"),s,this.props)},render(){return this.isValidType?i`<div class="${this.containerClassName}"><div class="${this.inputClassName}"><fc-label for="${this.for}">${this.props.label}</fc-label><input name="${this.props.name}" id="${this.internalId}" type="${this.props.type}" class="${this.className}"> ${this.slots.default}</div><div aria-live="polite" class="fc-form__invalid-feedback"><span></span></div><fc-help-text>${this.props.helpText}</fc-help-text></div>`:o}})}(e),function({createComponent:t,renderer:e,html:s,nothing:r=""}){const createOption=t=>{const e=document.createElement("option");return e.setAttribute("value",t.value),e.textContent=t.label,t.selected&&e.setAttribute("selected",""),t.disabled&&e.setAttribute("disabled",""),e};t("fc-select",{renderer:e,props:u,computed:{internalId(){return this.props.id?this.props.id:generateId("select")},for(){return n.indexOf(this.props.type)>-1||!this.props.label?"":this.internalId},selectOptions(){return this.props.options?Array.isArray(this.props.options)?this.props.options.map((t=>t instanceof c?s`<optgroup label="${t.label}" disabled="${t.disabled?t.disabled:void 0}">${t.options.map((t=>createOption(t)))}</optgroup>`:t instanceof d?createOption(t):(console.error("Unknown option - must be an instance of OptGroup or Option"),r))):(console.error("Options must be an array of OptGroup or Option instances"),[]):this.slots.default?this.slots.default.filter((t=>t.nodeType===Node.ELEMENT_NODE&&"option"===t.tagName.toLowerCase())).map((t=>new d(t.text,t.value,t.selected,t.disabled))).map((t=>createOption(t))):[]}},mounted(){setAttributes(this.querySelector("select"),u,this.props)},updated(){setAttributes(this.querySelector("select"),u,this.props)},render(){return s`<div class="${this.props.inline?"fc-form__group fc-form__group--inline":"fc-form__group"}"><div class="${this.props.multiple?"fc-form__select fc-form__select--multiple":"fc-form__select"}"><fc-label for="${this.for}">${this.props.label}</fc-label><select id="${this.internalId}" name="${this.props.name}">${this.selectOptions}</select></div><div aria-live="polite" class="fc-form__invalid-feedback"><span></span></div><fc-help-text>${this.props.helpText}</fc-help-text></div>`}})}(e),function({createComponent:t,renderer:e,html:s}){t("fc-textarea",{renderer:e,props:m,computed:{internalId(){return this.props.id?this.props.id:generateId("textarea")},for(){return n.indexOf(this.props.type)>-1||!this.props.label?"":this.internalId}},mounted(){setAttributes(this.querySelector("textarea"),m,this.props)},updated(){setAttributes(this.querySelector("textarea"),m,this.props)},render(){return s`<div class="fc-form__group"><div class="fc-form__textarea"><fc-label for="${this.for}">${this.props.label}</fc-label><textarea id="${this.internalId}" name="${this.props.name}">${this.slots.default}</textarea></div><div aria-live="polite" class="fc-form__invalid-feedback"><span></span></div><fc-help-text>${this.props.helpText}</fc-help-text></div>`}})}(e)}};export{c as OptGroup,d as Option,h as module};
